<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumeracion Basica</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Enumeracion Basica</h1><br/><strong><span style="text-decoration:underline;">ENUMERACIÓN CON PING</span></strong><br /><br /><div class="codebox"><div class="codebox">┌──<span style="color:#ff9d00;font-weight:700">(</span>kali@kali<span style="color:#ff9d00;font-weight:700">)</span>-[~]<br />└─$&nbsp;<span style="color:#ff9d00;font-weight:700">ping</span>&nbsp;-c&nbsp;1&nbsp;127.0.0.1<br />PING&nbsp;127.0.0.1&nbsp;<span style="color:#ff9d00;font-weight:700">(</span>127.0.0.1<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;56<span style="color:#ff9d00;font-weight:700">(</span>84<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;bytes&nbsp;of&nbsp;data.<br />64&nbsp;bytes&nbsp;from&nbsp;127.0.0.1<span style="color:#ff9d00;font-weight:700">:</span>&nbsp;icmp_seq=1&nbsp;ttl=64&nbsp;time=0.026&nbsp;ms<br /><br />---&nbsp;127.0.0.1&nbsp;<span style="color:#ff9d00;font-weight:700">ping</span>&nbsp;statistics&nbsp;---<br />1&nbsp;packets&nbsp;transmitted,&nbsp;1&nbsp;received,&nbsp;0%&nbsp;packet&nbsp;loss,&nbsp;time&nbsp;0ms<br />rtt&nbsp;min<span style="color:#ff9d00;font-weight:700">/</span>avg<span style="color:#ff9d00;font-weight:700">/</span>max<span style="color:#ff9d00;font-weight:700">/</span>mdev&nbsp;=&nbsp;0.026<span style="color:#ff9d00;font-weight:700">/</span>0.026<span style="color:#ff9d00;font-weight:700">/</span>0.026<span style="color:#ff9d00;font-weight:700">/</span>0.000&nbsp;ms</div></div><br /><br />Cuando hacemos el ping vemos que pone <strong>TTL</strong> y gracias a eso podemos identificar el sistema operativo del equipo<br /><br /><table class="table"><tr><th>Sistema Operativo</th><th>Time to Live</th></tr><tr><td>Linux</td><td>64</td></tr><tr><td>Windows</td><td>128</td></tr><tr><td>IOS y Cisco Routers</td><td>255</td></tr></table><br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN CON NMAP</span></strong><br /><br /><span style="text-decoration:underline;">Nmap con formato Grepeable y funcion en .bashrc para filtrado de puertos:</span><br /><br /><div class="codebox"><div class="codebox">┌──<span style="color:#ff9d00;font-weight:700">(</span>kali@kali<span style="color:#ff9d00;font-weight:700">)</span>-[~]<br />└─$&nbsp;nmap&nbsp;10.0.0.1&nbsp;-p-&nbsp;--open&nbsp;-T5&nbsp;-v&nbsp;-n&nbsp;-oG&nbsp;FicheroPuertos</div></div><br /><br /><div class="codebox"><div class="codebox"><span style="color:#ff9d00;font-weight:700">function</span>&nbsp;<span style="color:#ffdd00;font-weight:400">extractPorts()</span><span style="color:#ff9d00;font-weight:700">{</span><br />	<span style="color:#7f0044;font-weight:400">ip_address</span>=$<span style="color:#ff9d00;font-weight:700">(cat</span>&nbsp;allPorts&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">grep</span>&nbsp;-oP&nbsp;<span style="color:#3ad900;font-weight:400">&#39;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">sort</span>&nbsp;-u<span style="color:#ff9d00;font-weight:700">)</span><br />	<span style="color:#7f0044;font-weight:400">open_ports</span>=$<span style="color:#ff9d00;font-weight:700">(cat</span>&nbsp;allPorts&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">grep</span>&nbsp;-oP&nbsp;<span style="color:#3ad900;font-weight:400">&#39;\d{1,5}/open&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">awk</span>&nbsp;<span style="color:#3ad900;font-weight:400">&#39;{print&nbsp;$1}&#39;</span>&nbsp;FS=<span style="color:#3ad900;font-weight:400">&quot;/&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">xargs</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">tr</span>&nbsp;<span style="color:#3ad900;font-weight:400">&#39;&nbsp;&#39;</span>&nbsp;<span style="color:#3ad900;font-weight:400">&#39;,&#39;</span><span style="color:#ff9d00;font-weight:700">)</span><br /><br />	<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;-e&nbsp;<span style="color:#3ad900;font-weight:400">&quot;\t${blueColour}[*]&nbsp;IP&nbsp;Address:&nbsp;${endColour}${grayColour}$ip_address${endColour}&quot;</span><br />	<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;-e&nbsp;<span style="color:#3ad900;font-weight:400">&quot;\t${blueColour}[*]&nbsp;Open&nbsp;ports:&nbsp;${endColour}${grayColour}$open_ports${endColour}\n&quot;</span><br /><span style="color:#ff9d00;font-weight:700">}</span></div></div><br /><br /><span style="text-decoration:underline;">Nmap agilizado:</span><br /><br /><div class="codebox"><div class="codebox">┌──<span style="color:#ff9d00;font-weight:700">(</span>kali@kali<span style="color:#ff9d00;font-weight:700">)</span>-[~]<br />└─$&nbsp;nmap&nbsp;-sS&nbsp;--min-rate&nbsp;5000&nbsp;--open&nbsp;-vvv&nbsp;-n&nbsp;-Pn&nbsp;-p-&nbsp;10.0.0.1</div></div><br /><br /><span style="text-decoration:underline;">Nmap listar info servicios:</span><br /><br /><div class="codebox"><div class="codebox">┌──<span style="color:#ff9d00;font-weight:700">(</span>kali@kali<span style="color:#ff9d00;font-weight:700">)</span>-[~]<br />└─$&nbsp;nmap&nbsp;-sC&nbsp;-sV&nbsp;-T4&nbsp;-p-&nbsp;10.0.0.1&nbsp;-oN&nbsp;resultados</div></div><br /><br /><span style="text-decoration:underline;">Listar categorias scripts nmap:</span><br /><br /><div class="codebox"><div class="codebox">┌──<span style="color:#ff9d00;font-weight:700">(</span>kali@kali<span style="color:#ff9d00;font-weight:700">)</span>-[~]<br />└─$&nbsp;<span style="color:#ff9d00;font-weight:700">locate</span>&nbsp;.nse&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">xargs</span>&nbsp;<span style="color:#ff9d00;font-weight:700">grep</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;categories&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">grep</span>&nbsp;-oP&nbsp;<span style="color:#3ad900;font-weight:400">&#39;&quot;.*?&quot;&#39;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">|</span>&nbsp;<span style="color:#ff9d00;font-weight:700">sort</span>&nbsp;-u</div></div><br /><br /><span style="text-decoration:underline;">Script enum-http nmap:</span><br /><br /><div class="codebox"><div class="codebox">┌──<span style="color:#ff9d00;font-weight:700">(</span>kali@kali<span style="color:#ff9d00;font-weight:700">)</span>-[~]<br />└─$&nbsp;nmap&nbsp;--script&nbsp;http-enum&nbsp;-p80&nbsp;10.0.0.1</div></div><br /><br /><span style="color:#ff0000;">RECORDAR!!!!</span> → Para sacar información relevante de un servidor web podemos utilizar tambien un plugin de navegador llamado “Wappalyzer”<br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN PUERTOS CON SCRIPT BASH</span></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/bin/bash</span><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;[&nbsp;-n&nbsp;<span style="color:#3ad900;font-weight:400">&quot;$1&quot;</span>&nbsp;]<span style="color:#ff9d00;font-weight:700">;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">then</span><br />	<span style="color:#7f0044;font-weight:400">ip_address</span>=<span style="color:#7f0044;font-weight:400">$1</span><br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;<span style="color:#7f0044;font-weight:400">port</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;$<span style="color:#ff9d00;font-weight:700">(seq</span>&nbsp;1&nbsp;65535<span style="color:#ff9d00;font-weight:700">);</span>&nbsp;<span style="color:#ff9d00;font-weight:700">do</span><br />		timeout&nbsp;1&nbsp;<span style="color:#ff9d00;font-weight:700">bash</span>&nbsp;-c&nbsp;<span style="color:#3ad900;font-weight:400">&quot;echo&nbsp;&#39;&#39;&nbsp;&gt;&nbsp;/dev/tcp/$ip_address/$port&quot;</span>&nbsp;2&gt;<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>null&nbsp;<span style="color:#ff9d00;font-weight:700">&amp;&amp;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;[*]&nbsp;Puerto&nbsp;$port&nbsp;-&nbsp;abierto&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">&amp;</span><br />	<span style="color:#ff9d00;font-weight:700">done;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">wait</span><br /><span style="color:#ff9d00;font-weight:700">else</span><br />	<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;-e&nbsp;<span style="color:#3ad900;font-weight:400">&quot;\n[!]&nbsp;Uso:&nbsp;./nombrescript.sh&nbsp;&lt;ip&gt;\n&quot;</span><br />	<span style="color:#ff9d00;font-weight:700">exit</span>&nbsp;1<br /><span style="color:#ff9d00;font-weight:700">fi</span><br /></div></div><br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN EQUIPOS CON SCRIPT BASH</span></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/bin/bash</span><br /><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;[&nbsp;-n&nbsp;<span style="color:#3ad900;font-weight:400">&quot;$1&quot;</span>&nbsp;]<span style="color:#ff9d00;font-weight:700">;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">then</span><br />	<span style="color:#7f0044;font-weight:400">ip_address</span>=<span style="color:#7f0044;font-weight:400">$1</span><br />	<span style="color:#ff9d00;font-weight:700">for</span>&nbsp;<span style="color:#7f0044;font-weight:400">i</span>&nbsp;<span style="color:#ff9d00;font-weight:700">in</span>&nbsp;$<span style="color:#ff9d00;font-weight:700">(seq</span>&nbsp;1&nbsp;254<span style="color:#ff9d00;font-weight:700">);</span>&nbsp;<span style="color:#ff9d00;font-weight:700">do</span><br />	timeout&nbsp;1&nbsp;<span style="color:#ff9d00;font-weight:700">bash</span>&nbsp;-c&nbsp;<span style="color:#3ad900;font-weight:400">&quot;ping&nbsp;-c&nbsp;1&nbsp;$ip_address.$i&nbsp;&gt;&nbsp;/dev/null&nbsp;2&gt;&amp;1&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">&amp;&amp;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;[*]&nbsp;Host&nbsp;$ip_address.$i&nbsp;-&nbsp;ACTIVO&quot;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">&amp;</span><br />	<span style="color:#ff9d00;font-weight:700">done;</span>&nbsp;<span style="color:#ff9d00;font-weight:700">wait</span><br /><span style="color:#ff9d00;font-weight:700">else</span><br />	<span style="color:#ff9d00;font-weight:700">echo</span>&nbsp;-e&nbsp;<span style="color:#3ad900;font-weight:400">&quot;\n[!]&nbsp;Uso:&nbsp;./nombrescript.sh&nbsp;&lt;ip&gt;\n&quot;</span><br />	<span style="color:#ff9d00;font-weight:700">exit</span>&nbsp;1<br /><span style="color:#ff9d00;font-weight:700">fi</span><br /></div></div><br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN OS CON SCRIPT PYTHON</span></strong><br /><br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python3</span><br /><span style="color:#0088ff;font-weight:400">#coding:&nbsp;utf-8</span><br /><br />import&nbsp;re,&nbsp;sys,&nbsp;subprocess<br /><br /><span style="color:#0088ff;font-weight:400">#&nbsp;python3&nbsp;whichSystem.py&nbsp;10.10.10.205</span><br /><br />ip&nbsp;=&nbsp;re.compile<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&quot;</span><span style="color:#ff9d00;font-weight:700">)</span><br /><br />def&nbsp;<span style="color:#ffdd00;font-weight:400">dato_erroneo()</span><span style="color:#ff9d00;font-weight:700">:</span><br /><br />		<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;len<span style="color:#ff9d00;font-weight:700">(</span>sys.argv<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;<span style="color:#ff9d00;font-weight:700">!</span>=&nbsp;2&nbsp;or&nbsp;sys.argv[1]&nbsp;<span style="color:#ff9d00;font-weight:700">!</span>=&nbsp;ip<span style="color:#ff9d00;font-weight:700">:</span><br />			print<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;\n[!]&nbsp;Uso:&nbsp;python3&nbsp;&quot;</span>&nbsp;+&nbsp;sys.argv[0]&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">&quot;&nbsp;&lt;direccion-ip&gt;\n&quot;</span><span style="color:#ff9d00;font-weight:700">)</span><br />			sys.exit<span style="color:#ff9d00;font-weight:700">(</span>1<span style="color:#ff9d00;font-weight:700">)</span><br /><br /><br />def&nbsp;get_ttl<span style="color:#ff9d00;font-weight:700">(</span>ip_address<span style="color:#ff9d00;font-weight:700">):</span><br /><br />	proc&nbsp;=&nbsp;subprocess.Popen<span style="color:#ff9d00;font-weight:700">(</span>[<span style="color:#3ad900;font-weight:400">&quot;/usr/bin/ping&nbsp;-c&nbsp;1&nbsp;%s&quot;</span>&nbsp;%&nbsp;ip_address,&nbsp;<span style="color:#3ad900;font-weight:400">&quot;&quot;</span>],&nbsp;stdout=subprocess.PIPE,&nbsp;shell=True<span style="color:#ff9d00;font-weight:700">)</span><br />	<br />	<span style="color:#ff9d00;font-weight:700">(</span>out,err<span style="color:#ff9d00;font-weight:700">)</span>&nbsp;=&nbsp;proc.<span style="color:#ffdd00;font-weight:400">communicate()</span><br /><br />	out&nbsp;=&nbsp;out.<span style="color:#ffdd00;font-weight:400">split()</span><br />	out&nbsp;=&nbsp;out[12].decode<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&#39;utf-8&#39;</span><span style="color:#ff9d00;font-weight:700">)</span><br /><br />	try<span style="color:#ff9d00;font-weight:700">:</span><br /><br />		ttl_value&nbsp;=&nbsp;re.findall<span style="color:#ff9d00;font-weight:700">(</span>r<span style="color:#3ad900;font-weight:400">&quot;\d{1,3}&quot;</span>,&nbsp;out<span style="color:#ff9d00;font-weight:700">)</span>[0]<br />		<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;ttl_value<br />		<br />	except&nbsp;IndexError<span style="color:#ff9d00;font-weight:700">:</span><br /><br />		print<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;Machine&nbsp;out&nbsp;of&nbsp;order&quot;</span><span style="color:#ff9d00;font-weight:700">)</span><br />		sys.exit<span style="color:#ff9d00;font-weight:700">(</span>1<span style="color:#ff9d00;font-weight:700">)</span><br /><br /><br />def&nbsp;get_os<span style="color:#ff9d00;font-weight:700">(</span>ttl<span style="color:#ff9d00;font-weight:700">):</span><br /><br />	ttl&nbsp;=&nbsp;int<span style="color:#ff9d00;font-weight:700">(</span>ttl<span style="color:#ff9d00;font-weight:700">)</span><br /><br />	<span style="color:#ff9d00;font-weight:700">if</span>&nbsp;ttl&nbsp;&gt;=0&nbsp;and&nbsp;ttl&nbsp;&lt;=64<span style="color:#ff9d00;font-weight:700">:</span><br />		<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;Linux&quot;</span><br />	<br />	<span style="color:#ff9d00;font-weight:700">elif</span>&nbsp;ttl&nbsp;&gt;=&nbsp;65&nbsp;and&nbsp;ttl&nbsp;&lt;=&nbsp;128<span style="color:#ff9d00;font-weight:700">:</span><br />		<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;Windows&quot;</span><br />		<br />	else<span style="color:#ff9d00;font-weight:700">:</span><br />		<span style="color:#ff9d00;font-weight:700">return</span>&nbsp;<span style="color:#3ad900;font-weight:400">&quot;Not&nbsp;Found&quot;</span><br />		<br />	<br /><br /><span style="color:#ff9d00;font-weight:700">if</span>&nbsp;__name__&nbsp;==&nbsp;<span style="color:#3ad900;font-weight:400">&#39;__main__&#39;</span><span style="color:#ff9d00;font-weight:700">:</span><br /><br />	try<span style="color:#ff9d00;font-weight:700">:</span><br /><br />		ip_address&nbsp;=&nbsp;sys.argv[1]<br />		<br />		ttl&nbsp;=&nbsp;get_ttl<span style="color:#ff9d00;font-weight:700">(</span>ip_address<span style="color:#ff9d00;font-weight:700">)</span><br /><br />		os_name&nbsp;=&nbsp;get_os<span style="color:#ff9d00;font-weight:700">(</span>ttl<span style="color:#ff9d00;font-weight:700">)</span><br /><br />		print<span style="color:#ff9d00;font-weight:700">(</span><span style="color:#3ad900;font-weight:400">&quot;%s&nbsp;(ttl&nbsp;-&gt;&nbsp;%s):&nbsp;%s&quot;</span>&nbsp;%&nbsp;<span style="color:#ff9d00;font-weight:700">(</span>ip_address,&nbsp;ttl,&nbsp;os_name<span style="color:#ff9d00;font-weight:700">))</span><br /><br /><br />	except<span style="color:#ff9d00;font-weight:700">:</span><br /><br />		<span style="color:#ffdd00;font-weight:400">dato_erroneo()</span><br /><br /></div></div><br /><br /><br /><br /><br /><a href="Enumeracion.html">Volver al indice</a><br /><br /><br /></div>
</body>
</html>
