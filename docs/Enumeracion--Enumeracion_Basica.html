<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumeracion Basica</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Enumeracion Basica</h1><br/><strong><span style="text-decoration:underline;">ENUMERACIÓN CON PING</span></strong><br /><br /><div class="codebox"><div class="codebox">┌──(kali@kali)-[~]<br />└─$&nbsp;ping&nbsp;-c&nbsp;1&nbsp;127.0.0.1<br />PING&nbsp;127.0.0.1&nbsp;(127.0.0.1)&nbsp;56(84)&nbsp;bytes&nbsp;of&nbsp;data.<br />64&nbsp;bytes&nbsp;from&nbsp;127.0.0.1:&nbsp;icmp_seq=1&nbsp;ttl=64&nbsp;time=0.026&nbsp;ms<br /><br />---&nbsp;127.0.0.1&nbsp;ping&nbsp;statistics&nbsp;---<br />1&nbsp;packets&nbsp;transmitted,&nbsp;1&nbsp;received,&nbsp;0%&nbsp;packet&nbsp;loss,&nbsp;time&nbsp;0ms<br />rtt&nbsp;min/avg/max/mdev&nbsp;=&nbsp;0.026/0.026/0.026/0.000&nbsp;ms</div></div><br /><br />Cuando hacemos el ping vemos que pone <strong>TTL</strong> y gracias a eso podemos identificar el sistema operativo del equipo<br /><br /><table class="table"><tr><th>Sistema Operativo</th><th>Time to Live</th></tr><tr><td>Linux</td><td>64</td></tr><tr><td>Windows</td><td>128</td></tr><tr><td>IOS y Cisco Routers</td><td>255</td></tr></table><br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN CON NMAP</span></strong><br /><br /><span style="text-decoration:underline;">Nmap con formato Grepeable y funcion en .bashrc para filtrado de puertos:</span><br /><br /><div class="codebox"><div class="codebox">┌──(kali@kali)-[~]<br />└─$&nbsp;nmap&nbsp;10.0.0.1&nbsp;-p-&nbsp;--open&nbsp;-T5&nbsp;-v&nbsp;-n&nbsp;-oG&nbsp;FicheroPuertos</div></div><br /><br /><div class="codebox"><div class="codebox">function&nbsp;extractPorts(){<br />	ip_address=$(cat&nbsp;allPorts&nbsp;|&nbsp;grep&nbsp;-oP&nbsp;&#39;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&#39;&nbsp;|&nbsp;sort&nbsp;-u)<br />	open_ports=$(cat&nbsp;allPorts&nbsp;|&nbsp;grep&nbsp;-oP&nbsp;&#39;\d{1,5}/open&#39;&nbsp;|&nbsp;awk&nbsp;&#39;{print&nbsp;$1}&#39;&nbsp;FS=&quot;/&quot;&nbsp;|&nbsp;xargs&nbsp;|&nbsp;tr&nbsp;&#39;&nbsp;&#39;&nbsp;&#39;,&#39;)<br /><br />	echo&nbsp;-e&nbsp;&quot;\t${blueColour}[*]&nbsp;IP&nbsp;Address:&nbsp;${endColour}${grayColour}$ip_address${endColour}&quot;<br />	echo&nbsp;-e&nbsp;&quot;\t${blueColour}[*]&nbsp;Open&nbsp;ports:&nbsp;${endColour}${grayColour}$open_ports${endColour}\n&quot;<br />}</div></div><br /><br /><span style="text-decoration:underline;">Nmap agilizado:</span><br /><br /><div class="codebox"><div class="codebox">┌──(kali@kali)-[~]<br />└─$&nbsp;nmap&nbsp;-sS&nbsp;--min-rate&nbsp;5000&nbsp;--open&nbsp;-vvv&nbsp;-n&nbsp;-Pn&nbsp;-p-&nbsp;10.0.0.1</div></div><br /><br /><span style="text-decoration:underline;">Nmap listar info servicios:</span><br /><br /><div class="codebox"><div class="codebox">┌──(kali@kali)-[~]<br />└─$&nbsp;nmap&nbsp;-sC&nbsp;-sV&nbsp;-T4&nbsp;-p-&nbsp;10.0.0.1&nbsp;-oN&nbsp;resultados</div></div><br /><br /><span style="text-decoration:underline;">Listar categorias scripts nmap:</span><br /><br /><div class="codebox"><div class="codebox">┌──(kali@kali)-[~]<br />└─$&nbsp;locate&nbsp;.nse&nbsp;|&nbsp;xargs&nbsp;grep&nbsp;&quot;categories&quot;&nbsp;|&nbsp;grep&nbsp;-oP&nbsp;&#39;&quot;.*?&quot;&#39;&nbsp;|&nbsp;sort&nbsp;-u</div></div><br /><br /><span style="text-decoration:underline;">Script enum-http nmap:</span><br /><br /><div class="codebox"><div class="codebox">┌──(kali@kali)-[~]<br />└─$&nbsp;nmap&nbsp;--script&nbsp;http-enum&nbsp;-p80&nbsp;10.0.0.1</div></div><br /><br /><span style="color:#ff0000;">RECORDAR!!!!</span> → Para sacar información relevante de un servidor web podemos utilizar tambien un plugin de navegador llamado “Wappalyzer”<br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN PUERTOS CON SCRIPT BASH</span></strong><br /><br /><div class="codebox"><div class="codebox">#!/bin/bash<br />if&nbsp;[&nbsp;-n&nbsp;&quot;$1&quot;&nbsp;];&nbsp;then<br />	ip_address=$1<br />	for&nbsp;port&nbsp;in&nbsp;$(seq&nbsp;1&nbsp;65535);&nbsp;do<br />		timeout&nbsp;1&nbsp;bash&nbsp;-c&nbsp;&quot;echo&nbsp;&#39;&#39;&nbsp;&gt;&nbsp;/dev/tcp/$ip_address/$port&quot;&nbsp;2&gt;/dev/null&nbsp;&amp;&amp;&nbsp;echo&nbsp;&quot;[*]&nbsp;Puerto&nbsp;$port&nbsp;-&nbsp;abierto&quot;&nbsp;&amp;<br />	done;&nbsp;wait<br />else<br />	echo&nbsp;-e&nbsp;&quot;\n[!]&nbsp;Uso:&nbsp;./nombrescript.sh&nbsp;&lt;ip&gt;\n&quot;<br />	exit&nbsp;1<br />fi<br /></div></div><br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN EQUIPOS CON SCRIPT BASH</span></strong><br /><br /><div class="codebox"><div class="codebox">#!/bin/bash<br /><br />if&nbsp;[&nbsp;-n&nbsp;&quot;$1&quot;&nbsp;];&nbsp;then<br />	ip_address=$1<br />	for&nbsp;i&nbsp;in&nbsp;$(seq&nbsp;1&nbsp;254);&nbsp;do<br />	timeout&nbsp;1&nbsp;bash&nbsp;-c&nbsp;&quot;ping&nbsp;-c&nbsp;1&nbsp;$ip_address.$i&nbsp;&gt;&nbsp;/dev/null&nbsp;2&gt;&amp;1&quot;&nbsp;&amp;&amp;&nbsp;echo&nbsp;&quot;[*]&nbsp;Host&nbsp;$ip_address.$i&nbsp;-&nbsp;ACTIVO&quot;&nbsp;&amp;<br />	done;&nbsp;wait<br />else<br />	echo&nbsp;-e&nbsp;&quot;\n[!]&nbsp;Uso:&nbsp;./nombrescript.sh&nbsp;&lt;ip&gt;\n&quot;<br />	exit&nbsp;1<br />fi<br /></div></div><br /><br /><strong><span style="text-decoration:underline;">ENUMERACIÓN OS CON SCRIPT PYTHON</span></strong><br /><br /><div class="codebox"><div class="codebox">#!/usr/bin/python3<br />#coding:&nbsp;utf-8<br /><br />import&nbsp;re,&nbsp;sys,&nbsp;subprocess<br /><br />#&nbsp;python3&nbsp;whichSystem.py&nbsp;10.10.10.205<br /><br />ip&nbsp;=&nbsp;re.compile(&quot;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&quot;)<br /><br />def&nbsp;dato_erroneo():<br /><br />		if&nbsp;len(sys.argv)&nbsp;!=&nbsp;2&nbsp;or&nbsp;sys.argv[1]&nbsp;!=&nbsp;ip:<br />			print(&quot;\n[!]&nbsp;Uso:&nbsp;python3&nbsp;&quot;&nbsp;+&nbsp;sys.argv[0]&nbsp;+&nbsp;&quot;&nbsp;&lt;direccion-ip&gt;\n&quot;)<br />			sys.exit(1)<br /><br /><br />def&nbsp;get_ttl(ip_address):<br /><br />	proc&nbsp;=&nbsp;subprocess.Popen([&quot;/usr/bin/ping&nbsp;-c&nbsp;1&nbsp;%s&quot;&nbsp;%&nbsp;ip_address,&nbsp;&quot;&quot;],&nbsp;stdout=subprocess.PIPE,&nbsp;shell=True)<br />	<br />	(out,err)&nbsp;=&nbsp;proc.communicate()<br /><br />	out&nbsp;=&nbsp;out.split()<br />	out&nbsp;=&nbsp;out[12].decode(&#39;utf-8&#39;)<br /><br />	try:<br /><br />		ttl_value&nbsp;=&nbsp;re.findall(r&quot;\d{1,3}&quot;,&nbsp;out)[0]<br />		return&nbsp;ttl_value<br />		<br />	except&nbsp;IndexError:<br /><br />		print(&quot;Machine&nbsp;out&nbsp;of&nbsp;order&quot;)<br />		sys.exit(1)<br /><br /><br />def&nbsp;get_os(ttl):<br /><br />	ttl&nbsp;=&nbsp;int(ttl)<br /><br />	if&nbsp;ttl&nbsp;&gt;=0&nbsp;and&nbsp;ttl&nbsp;&lt;=64:<br />		return&nbsp;&quot;Linux&quot;<br />	<br />	elif&nbsp;ttl&nbsp;&gt;=&nbsp;65&nbsp;and&nbsp;ttl&nbsp;&lt;=&nbsp;128:<br />		return&nbsp;&quot;Windows&quot;<br />		<br />	else:<br />		return&nbsp;&quot;Not&nbsp;Found&quot;<br />		<br />	<br /><br />if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:<br /><br />	try:<br /><br />		ip_address&nbsp;=&nbsp;sys.argv[1]<br />		<br />		ttl&nbsp;=&nbsp;get_ttl(ip_address)<br /><br />		os_name&nbsp;=&nbsp;get_os(ttl)<br /><br />		print(&quot;%s&nbsp;(ttl&nbsp;-&gt;&nbsp;%s):&nbsp;%s&quot;&nbsp;%&nbsp;(ip_address,&nbsp;ttl,&nbsp;os_name))<br /><br /><br />	except:<br /><br />		dato_erroneo()<br /><br /></div></div><br /><br /><br /><br /><br /><a href="Enumeracion.html">Volver al indice</a><br /><br /><br /></div>
</body>
</html>
